<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grocery Store Management System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // API Configuration - CONNECTED TO PYTHON BACKEND
        const API_URL = 'http://localhost:5000/api';

        // API Helper Functions (Kept as is for backend interaction)
        const api = {
            // ... (All API functions from original code) ...
            login: async (username, password) => {
                const response = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ username, password })
                });
                return await response.json();
            },
            logout: async () => {
                const response = await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                return await response.json();
            },
            checkSession: async () => {
                const response = await fetch(`${API_URL}/auth/session`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            // Products
            getProducts: async (category = '', search = '') => {
                const params = new URLSearchParams();
                if (category) params.append('category', category);
                if (search) params.append('search', search);
                const response = await fetch(`${API_URL}/products?${params}`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            addProduct: async (productData) => {
                const response = await fetch(`${API_URL}/products`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(productData)
                });
                return await response.json();
            },
            updateProduct: async (id, productData) => {
                const response = await fetch(`${API_URL}/products/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(productData)
                });
                return await response.json();
            },
            deleteProduct: async (id) => {
                const response = await fetch(`${API_URL}/products/${id}`, {
                    method: 'DELETE',
                    credentials: 'include'
                });
                return await response.json();
            },
            getCategories: async () => {
                const response = await fetch(`${API_URL}/products/categories`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            getLowStock: async () => {
                const response = await fetch(`${API_URL}/products/low-stock`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            // Customers
            getCustomers: async () => {
                const response = await fetch(`${API_URL}/customers`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            addCustomer: async (customerData) => {
                const response = await fetch(`${API_URL}/customers`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(customerData)
                });
                return await response.json();
            },
            getCustomer: async (id) => {
                const response = await fetch(`${API_URL}/customers/${id}`, {
                    credentials: 'include'
                });
                return await response.json();
            },
            // Transactions
            addBorrow: async (transactionData) => {
                const response = await fetch(`${API_URL}/transactions/borrow`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(transactionData)
                });
                return await response.json();
            },
            addRepayment: async (transactionData) => {
                const response = await fetch(`${API_URL}/transactions/repay`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(transactionData)
                });
                return await response.json();
            },
            // Analytics
            getDashboard: async () => {
                const response = await fetch(`${API_URL}/analytics/dashboard`, {
                    credentials: 'include'
                });
                return await response.json();
            }
        };

        // Login Component (Kept as is)
        function Login({ onLogin }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleLogin = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError('');
                
                try {
                    const result = await api.login(username, password);
                    if (result.success) {
                        onLogin(result.user);
                    } else {
                        setError(result.message || 'Invalid credentials');
                    }
                } catch (err) {
                    setError('Connection error. Make sure backend is running on http://localhost:5000');
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <i className="fas fa-store text-5xl text-blue-600 mb-4"></i>
                            <h1 className="text-3xl font-bold text-gray-800">Grocery Store</h1>
                            <p className="text-gray-600">Management System</p>
                        </div>
                        <form onSubmit={handleLogin} className="space-y-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                <input
                                    type="text"
                                    value={username}
                                    onChange={(e) => setUsername(e.target.value)}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    placeholder="Enter username"
                                    required
                                    disabled={loading}
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    placeholder="Enter password"
                                    required
                                    disabled={loading}
                                />
                            </div>
                            {error && (
                                <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                                    {error}
                                </div>
                            )}
                            <button
                                type="submit"
                                disabled={loading}
                                className="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition disabled:bg-gray-400"
                            >
                                {loading ? 'Logging in...' : 'Login'}
                            </button>
                        </form>
                        <div className="mt-6 text-sm text-gray-600 text-center">
                            <p className="mb-2">Demo Credentials:</p>
                            <p><strong>Owner:</strong> owner / owner123</p>
                            <p><strong>Staff:</strong> staff1 / staff123</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Dashboard Component (Kept as is)
        function Dashboard() {
            const [dashboardData, setDashboardData] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadDashboard();
            }, []);

            const loadDashboard = async () => {
                try {
                    const data = await api.getDashboard();
                    setDashboardData(data);
                } catch (err) {
                    console.error('Error loading dashboard:', err);
                } finally {
                    setLoading(false);
                }
            };

            if (loading) {
                return <div className="text-center py-8">Loading dashboard...</div>;
            }

            if (!dashboardData) {
                return <div className="text-center py-8 text-red-600">Error loading dashboard</div>;
            }

            return (
                <div className="space-y-6">
                    <h2 className="text-2xl font-bold text-gray-800">Dashboard</h2>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div className="bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl p-6 shadow-lg">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-blue-100 text-sm">Today's Sales</p>
                                    <p className="text-3xl font-bold mt-2">₹{dashboardData.today_sales}</p>
                                </div>
                                <i className="fas fa-chart-line text-4xl text-blue-200"></i>
                            </div>
                        </div>

                        <div className="bg-gradient-to-br from-red-500 to-red-600 text-white rounded-xl p-6 shadow-lg">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-red-100 text-sm">Outstanding Debt</p>
                                    <p className="text-3xl font-bold mt-2">₹{dashboardData.outstanding_debt}</p>
                                </div>
                                <i className="fas fa-exclamation-triangle text-4xl text-red-200"></i>
                            </div>
                        </div>

                        <div className="bg-gradient-to-br from-yellow-500 to-yellow-600 text-white rounded-xl p-6 shadow-lg">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-yellow-100 text-sm">Low Stock Items</p>
                                    <p className="text-3xl font-bold mt-2">{dashboardData.low_stock_count}</p>
                                </div>
                                <i className="fas fa-box-open text-4xl text-yellow-200"></i>
                            </div>
                        </div>

                        <div className="bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl p-6 shadow-lg">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-green-100 text-sm">Total Customers</p>
                                    <p className="text-3xl font-bold mt-2">{dashboardData.customer_count}</p>
                                </div>
                                <i className="fas fa-users text-4xl text-green-200"></i>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl p-6 shadow-lg">
                        <h3 className="text-xl font-bold text-gray-800 mb-4">Recent Transactions</h3>
                        <div className="space-y-3">
                            {dashboardData.recent_transactions && dashboardData.recent_transactions.map(transaction => (
                                <div key={transaction.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <p className="font-semibold text-gray-800">{transaction.customer_name}</p>
                                        <p className="text-sm text-gray-600">{transaction.description || 'No description'}</p>
                                    </div>
                                    <div className="text-right">
                                        <p className={`font-bold ${transaction.transaction_type === 'borrow' ? 'text-red-600' : 'text-green-600'}`}>
                                            {transaction.transaction_type === 'borrow' ? '-' : '+'}₹{transaction.amount}
                                        </p>
                                        <p className="text-xs text-gray-500">{new Date(transaction.created_at).toLocaleDateString()}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        /* --- Reusable Modals (Moved outside for better structure) --- */

        // Customer Form Modal (Used for Add/Edit Customer)
        const CustomerForm = ({ customer, onClose, onSave }) => {
            // Note: The original code's ProductForm had Customer fields, so this assumes it was meant to be a Customer Form.
            const initialFormData = customer || { name: '', phone: '', email: '', address: '' };
            const [formData, setFormData] = useState(initialFormData);
            const [saving, setSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setSaving(true);
                try {
                    let result;
                    if (customer) {
                        // Assuming you would have an updateCustomer API function
                        // result = await api.updateCustomer(customer.id, formData);
                        // For now, let's just use the addCustomer placeholder logic if update isn't available
                         result = await api.addCustomer(formData); // Placeholder
                    } else {
                        result = await api.addCustomer(formData);
                    }
                    onSave(result); // Call the onSave prop with the result
                    onClose();
                } catch (err) {
                    alert(`Error ${customer ? 'updating' : 'adding'} customer`);
                } finally {
                    setSaving(false);
                }
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
                        <h3 className="text-xl font-bold text-gray-800 mb-4">
                            {customer ? 'Edit Customer' : 'Add New Customer'}
                        </h3>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Customer Name</label>
                                <input
                                    type="text"
                                    value={formData.name}
                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    required
                                />
                            </div>
                            {/* The original product form had phone/email/address, retaining that structure for a customer */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                <input
                                    type="tel"
                                    value={formData.phone}
                                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    required
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input
                                    type="email"
                                    value={formData.email}
                                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Address</label>
                                <textarea
                                    value={formData.address}
                                    onChange={(e) => setFormData({ ...formData, address: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    rows="2"
                                ></textarea>
                            </div>
                            <div className="flex gap-3 pt-4">
                                <button
                                    type="submit"
                                    disabled={saving}
                                    className="flex-1 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 disabled:bg-gray-400"
                                >
                                    {saving ? 'Saving...' : (customer ? 'Update Customer' : 'Add Customer')}
                                </button>
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg font-semibold hover:bg-gray-400"
                                >
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };
        
        // Transaction Modal (Used for Borrow/Repay)
        const TransactionModal = ({ customer, onClose, transactionType, onSave }) => {
            const [amount, setAmount] = useState('');
            const [description, setDescription] = useState('');
            const [saving, setSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setSaving(true);
                try {
                    const transactionData = {
                        customer_id: customer.id,
                        amount: parseFloat(amount),
                        description
                    };
                    
                    let result;
                    if (transactionType === 'borrow') {
                        result = await api.addBorrow(transactionData);
                    } else {
                        result = await api.addRepayment(transactionData);
                    }
                    
                    onSave(result); // Call the onSave prop
                    onClose();
                } catch (err) {
                    alert('Error recording transaction');
                } finally {
                    setSaving(false);
                }
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl p-6 w-full max-w-md">
                        <h3 className="text-xl font-bold text-gray-800 mb-4">
                            {transactionType === 'borrow' ? 'Record Borrow' : 'Record Repayment'}
                        </h3>
                        <p className="text-gray-600 mb-4">Customer: <strong>{customer.name}</strong></p>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Amount (₹)</label>
                                <input
                                    type="number"
                                    value={amount}
                                    onChange={(e) => setAmount(e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    required
                                    min="0"
                                    step="0.01"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea
                                    value={description}
                                    onChange={(e) => setDescription(e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    rows="2"
                                    placeholder="Optional note..."
                                ></textarea>
                            </div>
                            <div className="flex gap-3 pt-4">
                                <button
                                    type="submit"
                                    disabled={saving}
                                    className="flex-1 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 disabled:bg-gray-400"
                                >
                                    {saving ? 'Saving...' : 'Submit'}
                                </button>
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg font-semibold hover:bg-gray-400"
                                >
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        /* --- New Customer Component (Refactored from original Products logic) --- */

        function Customers({ user }) {
            const [customers, setCustomers] = useState([]);
            const [loading, setLoading] = useState(true);
            const [showAddModal, setShowAddModal] = useState(false);
            const [showTransactionModal, setShowTransactionModal] = useState(false); // MISSING STATE
            const [selectedCustomer, setSelectedCustomer] = useState(null); // MISSING STATE
            const [transactionType, setTransactionType] = useState('borrow'); // MISSING STATE

            // The Products-related states (categories, searchTerm, selectedCategory, editingProduct) have been removed,
            // as this component is clearly for Customers.

            useEffect(() => {
                loadCustomers();
            }, []);

            const loadCustomers = async () => {
                setLoading(true);
                try {
                    const data = await api.getCustomers();
                    setCustomers(data);
                } catch (err) {
                    console.error('Error loading customers:', err);
                    setCustomers([]);
                } finally {
                    setLoading(false);
                }
            };
            
            // This function handles refreshing after Add/Update Customer or Transaction
            const handleSave = () => {
                loadCustomers();
            };

            if (loading) {
                return <div className="text-center py-8">Loading customers...</div>;
            }

            return (
                <div className="space-y-6">
                    <div className="flex items-center justify-between">
                        <h2 className="text-2xl font-bold text-gray-800">Customer Management</h2>
                        <button
                            onClick={() => {
                                setSelectedCustomer(null); // Ensure null for 'Add'
                                setShowAddModal(true);
                            }}
                            className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                        >
                            <i className="fas fa-user-plus"></i> Add Customer
                        </button>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {customers.map(customer => {
                            // Safely calculate balance, default to 0 if values are missing
                            const borrowed = customer.total_borrowed || 0;
                            const repaid = customer.total_repaid || 0;
                            const balance = borrowed - repaid;
                            
                            return (
                                <div key={customer.id} className="bg-white rounded-xl p-6 shadow-lg">
                                    <div className="flex items-start justify-between mb-4">
                                        <div>
                                            <h3 className="text-lg font-bold text-gray-800">{customer.name}</h3>
                                            <p className="text-sm text-gray-600">{customer.phone}</p>
                                            {customer.email && (
                                                <p className="text-sm text-gray-600">{customer.email}</p>
                                            )}
                                        </div>
                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center ${
                                            balance > 0 ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-600'
                                        }`}>
                                            <i className="fas fa-user text-xl"></i>
                                        </div>
                                    </div>

                                    <div className="space-y-2 mb-4">
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-600">Total Borrowed:</span>
                                            <span className="font-semibold text-red-600">₹{borrowed}</span>
                                        </div>
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-600">Total Repaid:</span>
                                            <span className="font-semibold text-green-600">₹{repaid}</span>
                                        </div>
                                        <div className="flex justify-between text-sm pt-2 border-t">
                                            <span className="text-gray-700 font-medium">Balance:</span>
                                            <span className={`font-bold ${balance > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                ₹{Math.abs(balance).toFixed(2)}
                                            </span>
                                        </div>
                                    </div>

                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => {
                                                setSelectedCustomer(customer);
                                                setTransactionType('borrow');
                                                setShowTransactionModal(true);
                                            }}
                                            className="flex-1 bg-red-100 text-red-700 py-2 rounded-lg hover:bg-red-200 text-sm font-medium"
                                        >
                                            Borrow
                                        </button>
                                        <button
                                            onClick={() => {
                                                setSelectedCustomer(customer);
                                                setTransactionType('repay');
                                                setShowTransactionModal(true);
                                            }}
                                            className="flex-1 bg-green-100 text-green-700 py-2 rounded-lg hover:bg-green-200 text-sm font-medium"
                                        >
                                            Repay
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    {showAddModal && (
                        <CustomerForm 
                            customer={selectedCustomer}
                            onClose={() => setShowAddModal(false)}
                            onSave={handleSave}
                        />
                    )}

                    {showTransactionModal && selectedCustomer && (
                        <TransactionModal
                            customer={selectedCustomer}
                            transactionType={transactionType}
                            onClose={() => {
                                setShowTransactionModal(false);
                                setSelectedCustomer(null);
                            }}
                            onSave={handleSave}
                        />
                    )}
                </div>
            );
        }

        /* --- Main App Component --- */
        function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('dashboard'); // 'dashboard', 'products', 'customers'
            const [loadingSession, setLoadingSession] = useState(true);

            useEffect(() => {
                checkUserSession();
            }, []);

            const checkUserSession = async () => {
                try {
                    const result = await api.checkSession();
                    if (result.success && result.user) {
                        setUser(result.user);
                    }
                } catch (error) {
                    console.error('Session check failed:', error);
                } finally {
                    setLoadingSession(false);
                }
            };

            const handleLogout = async () => {
                try {
                    await api.logout();
                } catch (err) {
                    console.error('Logout failed:', err);
                } finally {
                    setUser(null);
                    setView('dashboard'); // Default view after logout
                }
            };

            const renderView = () => {
                if (loadingSession) {
                    return <div className="text-center py-20 text-xl font-medium">Checking session...</div>;
                }

                if (!user) {
                    return <Login onLogin={setUser} />;
                }

                switch (view) {
                    case 'dashboard':
                        return <Dashboard user={user} />;
                    case 'products':
                        // Placeholder, assuming a 'Products' component exists or will be added.
                        return <ProductsComponent user={user} />; 
                    case 'customers':
                        return <Customers user={user} />;
                    default:
                        return <Dashboard user={user} />;
                }
            };

            // Placeholder for ProductsComponent
            const ProductsComponent = ({ user }) => {
                const [products, setProducts] = useState([]);
                // ... (omitted product logic to keep this focused on the fix)
                return <div className="py-8">
                    <h2 className="text-2xl font-bold mb-4">Products (Placeholder)</h2>
                    <p>Product listing logic would go here.</p>
                </div>
            };


            if (!user && !loadingSession) {
                return <Login onLogin={setUser} />;
            }

            // Main layout for logged-in user
            return (
                <div className="min-h-screen bg-gray-100 flex">
                    {user && (
                        <nav className="w-64 bg-white shadow-lg p-6 flex flex-col justify-between">
                            <div>
                                <div className="text-center mb-10">
                                    <i className="fas fa-store text-4xl text-blue-600 mb-2"></i>
                                    <h1 className="text-xl font-bold text-gray-800">GSMS</h1>
                                </div>
                                <ul className="space-y-2">
                                    <li>
                                        <a href="#" onClick={() => setView('dashboard')} className={`flex items-center p-3 rounded-lg transition ${view === 'dashboard' ? 'bg-blue-100 text-blue-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'}`}>
                                            <i className="fas fa-chart-pie mr-3"></i> Dashboard
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" onClick={() => setView('products')} className={`flex items-center p-3 rounded-lg transition ${view === 'products' ? 'bg-blue-100 text-blue-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'}`}>
                                            <i className="fas fa-boxes mr-3"></i> Products
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" onClick={() => setView('customers')} className={`flex items-center p-3 rounded-lg transition ${view === 'customers' ? 'bg-blue-100 text-blue-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'}`}>
                                            <i className="fas fa-users mr-3"></i> Customers
                                        </a>
                                    </li>
                                    {/* Add more links based on user role if needed */}
                                </ul>
                            </div>
                            <div className="pt-6 border-t border-gray-200">
                                <p className="text-sm text-gray-700 mb-2">Logged in as: <strong>{user.username} ({user.role})</strong></p>
                                <button 
                                    onClick={handleLogout}
                                    className="w-full text-left p-3 rounded-lg text-red-600 hover:bg-red-50 transition flex items-center"
                                >
                                    <i className="fas fa-sign-out-alt mr-3"></i> Logout
                                </button>
                            </div>
                        </nav>
                    )}
                    <main className="flex-1 p-8 overflow-y-auto">
                        {renderView()}
                    </main>
                </div>
            );
        }

        // Initialize App
        ReactDOM.render(<App />, document.getElementById('root'));

    </script>
</body>
</html>